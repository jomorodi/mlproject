<html>
    <head>
      <title>Single pafe App to check if a message is spam </title>
      <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
      <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
      <py-env>   
- scikit-learn                
- matplotlib
- pandas
- paths:
  - ./spam_ham_dataset.csv
          
      </py-env>    
    </head>

  <body>
    <div id="mlproject"></div>  
<form action="index.html" method="post" id="index">
<p> <label for="userinput"> Enter a messsage to check if it is a spam: </label> </p>
<textarea id="userinput" name="userinput" rows="4" cols="50"> </textarea>
<br>
<input type="submit" value="Submit">
</form>  
    <py-script>
import numpy as np
import pandas as pd
from js import document
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.feature_extraction.text import TfidfTransformer
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.svm import LinearSVC
df=pd.read_csv('./spam_ham_dataset.csv' )
X = df['text'] 
y = df['label']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)
count_vect = CountVectorizer()
X_train_counts = count_vect.fit_transform(X_train)
tfidf_transformer = TfidfTransformer()
X_train_tfidf = tfidf_transformer.fit_transform(X_train_counts)
vectorizer = TfidfVectorizer()
X_train_tfidf = vectorizer.fit_transform(X_train)
clf = LinearSVC()
clf.fit(X_train_tfidf,y_train)
from sklearn.pipeline import Pipeline
text_clf = Pipeline([('tfidf', TfidfVectorizer()),
                     ('clf', LinearSVC()),])
text_clf.fit(X_train, y_train)
predictions = text_clf.predict(X_test)
res = list()


userRespnse = document.getElementById("userinput")
res.append( userRespnse.value )

ans = text_clf.predict(res)[0]
print ("{}, is not a spam".format(res)[0])if ans == "ham" else print ("{}, is a spam".format(res)[0])
    </py-script>
  </body>
</html>
